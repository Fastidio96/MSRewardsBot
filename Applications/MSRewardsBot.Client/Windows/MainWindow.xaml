<Window x:Class="MSRewardsBot.Client.Windows.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:window="clr-namespace:MSRewardsBot.Client.Windows"
        xmlns:local="clr-namespace:MSRewardsBot.Common.DataEntities.Stats;assembly=MSRewardsBot.Common"
        mc:Ignorable="d"
        Title="MS Rewards Bot"
        Height="450"
        Width="800"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanMinimize">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="35px" />
            <RowDefinition Height="*" />
            <RowDefinition Height="20px" />
            <RowDefinition Height="20px" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!-- Header - Selector -->
        <Grid Grid.Row="0"
              Grid.Column="0"
              Margin="10,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="4*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <ComboBox Grid.Row="0"
                      Grid.Column="0"
                      Margin="0,0,10,0"
                      Name="cmbAcc"
                      ItemsSource="{Binding Accounts}"
                      SelectedItem="{Binding SelectedAccount, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="{Binding Email}" />
                        </StackPanel>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
            <Button Grid.Row="0"
                    Grid.Column="1"
                    Name="btnAddAcc"
                    Content="+ Add MS account"
                    Click="BtnAddAcc_Click"
                    IsEnabled="{Binding ConnectedToServer}" />

        </Grid>

        <!-- Main content -->
        <ContentControl Grid.Row="1"
                        Grid.Column="0"
                        Content="{Binding SelectedAccountStats}">
            <ContentControl.ContentTemplate>
                <DataTemplate DataType="{x:Type local:MSAccountStats}">
                    <Grid Margin="10,5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="30" />
                            <RowDefinition Height="20" />
                            <RowDefinition Height="20" />
                            <RowDefinition Height="20" />
                            <RowDefinition Height="20" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="2*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Row="0"
                                   Grid.Column="0"
                                   Grid.ColumnSpan="3"
                                   Text="Stats"
                                   FontWeight="Bold"
                                   FontSize="15px"
                                   HorizontalAlignment="Center" />
                        <TextBlock Grid.Row="1"
                                   Grid.Column="0"
                                   Text="{Binding TotalAccountPoints, StringFormat=Total points available: {0}}" />
                        <TextBlock Grid.Row="2"
                                   Grid.Column="0"
                                   Text="{Binding CurrentAccountLevel, StringFormat=Current account level: {0}}" />
                        <TextBlock Grid.Row="3"
                                   Grid.Column="0"
                                   Text="{Binding CurrentAccountLevelPoints, StringFormat=Current account level points: {0}/500}" />
                        <TextBlock Grid.Row="4"
                                   Grid.Column="0"
                                   Text="{Binding LastDashboardUpdate, StringFormat=Last dashboard update: {0:HH:mm:ss dd/MM/yyyy}}" />
                        <TextBlock Grid.Row="3"
                                   Grid.Column="1">
                            <TextBlock.Text>
                                <MultiBinding StringFormat="PC points searches: {0}/{1}">
                                    <Binding Path="CurrentPointsPCSearches" />
                                    <Binding Path="MaxPointsPCSearches" />
                                </MultiBinding>
                            </TextBlock.Text>
                        </TextBlock>
                        <TextBlock Grid.Row="4"
                                   Grid.Column="1"
                                   Text="{Binding PCSearchesToDo, StringFormat=PC searches to do: {0}}" />
                        <TextBlock Grid.Row="3"
                                   Grid.Column="2">
                            <TextBlock.Text>
                                <MultiBinding StringFormat="Mobile points searches: {0}/{1}">
                                    <Binding Path="CurrentPointsMobileSearches" />
                                    <Binding Path="MaxPointsMobileSearches" />
                                </MultiBinding>
                            </TextBlock.Text>
                        </TextBlock>
                        <TextBlock Grid.Row="4"
                                   Grid.Column="2"
                                   Text="{Binding MobileSearchesToDo, StringFormat=Mobile searches to do: {0}}" />
                    </Grid>
                </DataTemplate>
            </ContentControl.ContentTemplate>
        </ContentControl>

        <!-- Footer -->
        <Grid Grid.Row="2"
              Grid.Column="0"
              Margin="10,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="125" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="50" />
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Row="0"
                       Grid.Column="0">
                <Run Text="Connection status:" />
                <Run Text="{Binding ConnectionState}" />
            </TextBlock>
            <TextBlock Grid.Row="0"
                       Grid.Column="1">
                <Run Text="User logged:" />
                <Run Text="{Binding IsUserLogged}" />
            </TextBlock>
            <StackPanel Grid.Row="0"
                        Grid.Column="2">
                <TextBlock Margin="0,0,20,0">
                 <Run Text="Connected as" />
                 <Run Text="{Binding Username}" />
                </TextBlock>
            </StackPanel>
            <StackPanel Grid.Row="0"
                        Grid.Column="3">
                <Button x:Name="btnLogout"
                        Content="Log out"
                        Click="BtnLogout_Click" />
            </StackPanel>

        </Grid>
        <Grid Grid.Row="3"
              Grid.Column="0"
              Margin="10,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Button Grid.Row="0"
                    Grid.Column="0"
                    x:Name="btnSettings"
                    Content=" Settings "
                    Click="BtnSettings_Click"
                    HorizontalAlignment="Left" />
            <TextBlock Grid.Row="0"
                       Grid.Column="1"
                       HorizontalAlignment="Center">
                <Hyperlink NavigateUri="https://github.com/Fastidio96"
                           RequestNavigate="Hyperlink_RequestNavigate">
                    <Run Text="Developed by Fastidio96" />
                    <InlineUIContainer>
                        <Viewbox Width="12"
                                 Height="12">
                            <Canvas Width="24"
                                    Height="24">
                                <Path Fill="White"
                                      Data="M12 0.5C5.65 0.5 0.5 5.65 0.5 12C0.5 17.3 3.85 21.8 8.2 23.4C8.8 23.5 9.05 23.15 9.05 22.85C9.05 22.6 9.04 21.85 9.03 20.9C5.7 21.55 5 19.6 5 19.6C4.45 18.4 3.7 18.1 3.7 18.1C2.6 17.5 3.8 17.5 3.8 17.5C5 17.55 5.55 18.7 5.55 18.7C6.65 20.5 8.3 20 9 19.7C9.1 18.95 9.4 18.45 9.75 18.15C7.1 17.85 4.35 16.8 4.35 12.05C4.35 10.7 4.8 9.6 5.6 8.75C5.45 8.45 5.05 7.1 5.7 5.3C5.7 5.3 6.7 5 9.05 6.65C9.95 6.35 10.9 6.2 11.85 6.2C12.8 6.2 13.75 6.35 14.65 6.65C17 5 18 5.3 18 5.3C18.65 7.1 18.25 8.45 18.1 8.75C18.9 9.6 19.35 10.7 19.35 12.05C19.35 16.8 16.6 17.85 13.95 18.15C14.35 18.5 14.75 19.25 14.75 20.35C14.75 21.9 14.74 22.55 14.74 22.85C14.74 23.15 15 23.5 15.6 23.4C19.95 21.8 23.3 17.3 23.3 12C23.3 5.65 18.15 0.5 12 0.5Z" />
                            </Canvas>
                        </Viewbox>  
                    </InlineUIContainer>
                </Hyperlink>
            </TextBlock>
            <TextBlock Grid.Row="0"
                       Grid.Column="2"
                       HorizontalAlignment="Right">
                         <Run Text="Version" />
                         <Run Text="{Binding Version}" />
            </TextBlock>
        </Grid>
    </Grid>
</Window>
